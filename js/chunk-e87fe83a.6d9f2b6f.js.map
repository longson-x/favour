{"version":3,"sources":["webpack:///./src/views/testCard/testCard.vue?0182","webpack:///./src/views/luck-card/luck-card.vue?9e01","webpack:///./src/views/testCard/testCard.vue?2546","webpack:///./src/views/luck-card/luck-card.vue?9250","webpack:///src/views/luck-card/luck-card.vue","webpack:///./src/views/luck-card/luck-card.vue?1899","webpack:///./src/views/luck-card/luck-card.vue","webpack:///src/views/testCard/testCard.vue","webpack:///./src/views/testCard/testCard.vue?07cc","webpack:///./src/views/testCard/testCard.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","option","staticRenderFns","style","fontSize","scratchFontSize","scratchTextStyle","_v","ref","on","touchmove","touchstart","touchend","props","type","Object","default","scratchColor","placeholder","fontStyle","fontColor","img","radio","data","left","top","width","height","canvas","ctx","created","mounted","parseInt","initSetting","methods","$refs","console","log","getBoundingClientRect","getContext","initCanvas","fillStyle","fillRect","fill","arr","split","splice","font","join","textAlign","textBaseline","fillText","globalCompositeOperation","coverImg","src","onload","e","preventDefault","beginPath","arc","mouseX","mouseY","Math","PI","checkComplete","alpha","count","percent","showResult","clearRect","num","floor","random","length","round","len","filter","result","$toast","component","components","luckCard"],"mappings":"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","file":"js/chunk-e87fe83a.6d9f2b6f.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./testCard.vue?vue&type=style&index=0&id=e6f0c2ba&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./testCard.vue?vue&type=style&index=0&id=e6f0c2ba&scoped=true&lang=less&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./luck-card.vue?vue&type=style&index=0&id=65b12614&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./luck-card.vue?vue&type=style&index=0&id=65b12614&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('div',{staticClass:\"center\"},[_c('luck-card',{attrs:{\"option\":_vm.option}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"canvasBox\"},[_c('div',{staticClass:\"award\"},[_c('div',{staticClass:\"title\"},[_c('p',{style:([{'fontSize': this.fontSize / 75 * _vm.option.scratchFontSize + 'px'}, _vm.option.scratchTextStyle])},[_vm._v(\" 恭喜中奖 \")])])]),_c('canvas',{ref:\"canvas\",on:{\"touchmove\":_vm.touchmove,\"touchstart\":_vm.touchstart,\"touchend\":_vm.touchend}})])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"canvasBox\">\r\n    <div class=\"award\">\r\n      <div class=\"title\">\r\n        <p :style=\"[{'fontSize': this.fontSize / 75 * option.scratchFontSize + 'px'}, option.scratchTextStyle]\">\r\n          恭喜中奖\r\n        </p>\r\n      </div>\r\n    </div>\r\n    <canvas\r\n      ref=\"canvas\"\r\n      @touchmove=\"touchmove\"\r\n      @touchstart=\"touchstart\"\r\n      @touchend=\"touchend\">\r\n    </canvas>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n  props: {\r\n    option: {\r\n      type: Object,\r\n      default: () => {\r\n        return {\r\n          // 底部文字样式\r\n          scratchFontSize: 0,\r\n          scratchTextStyle: {},\r\n          // 刮层设置\r\n          scratchColor: '', // 刮层颜色\r\n          placeholder: '', // 刮层上的文字（若要设置）\r\n          fontStyle: '', // 刮层上的文字样式\r\n          fontSize: 0, // 刮层上文字大小\r\n          fontColor: '', // 刮层上文字颜色\r\n          img: '', // 刮层上的图片（若要设置）\r\n          radio: 0.25, // 刮开面积占总面积的比例\r\n        }\r\n      },\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      left: 0,\r\n      top: 0,\r\n      width: 0,\r\n      height: 0,\r\n      canvas: null,\r\n      ctx: null,\r\n      fontSize: 0,\r\n    }\r\n  },\r\n  created() {\r\n  },\r\n  mounted() {\r\n    this.fontSize = parseInt(\r\n      window.getComputedStyle(document.documentElement, null)['font-size']\r\n    )\r\n    this.initSetting()\r\n  },\r\n  methods: {\r\n    initSetting() {\r\n      this.canvas = this.$refs.canvas\r\n      const { left, top, width, height } = this.canvas.getBoundingClientRect()\r\n      console.log(this.canvas.getBoundingClientRect())\r\n      this.left = left\r\n      this.top = top\r\n      this.width = width\r\n      this.height = height\r\n      this.canvas.width = width\r\n      this.canvas.height = height\r\n\r\n      this.ctx = this.canvas.getContext('2d')\r\n      this.initCanvas()\r\n    },\r\n    initCanvas() {\r\n      if (this.option.placeholder) {\r\n        this.ctx.fillStyle = this.option.scratchColor\r\n        this.ctx.fillRect(0, 0, this.width, this.height)\r\n        this.ctx.fill()\r\n        // 刮层上面的文字设置\r\n        if (this.option.fontStyle) {\r\n          let arr = []\r\n          arr = this.option.fontStyle.split(' ')\r\n          arr.splice(1, 0, `${this.option.fontSize * this.fontSize / 75 + 'px'}`)\r\n          this.ctx.font = arr.join(' ')\r\n        }\r\n        this.ctx.textAlign = 'center'\r\n        this.ctx.textBaseline = 'middle'\r\n        this.ctx.fillStyle = this.option.fontColor\r\n        this.ctx.fillText(this.option.placeholder, this.width / 2, this.height / 2)\r\n        // 在刮层上显示文字\r\n        this.ctx.globalCompositeOperation = 'destination-out'\r\n      } else if (this.option.img) {\r\n        // 画灰色涂层图片\r\n        const coverImg = new Image()\r\n        coverImg.src = this.option.img\r\n        coverImg.onload = () => {\r\n          console.log('图片加载成功')\r\n          this.ctx.drawImage(coverImg, 0, 0, this.width, this.height)\r\n          this.ctx.globalCompositeOperation = 'destination-out'\r\n        }\r\n      }\r\n    },\r\n    touchstart(e) {\r\n      e.preventDefault()\r\n    },\r\n\r\n    touchmove(e) {\r\n      e.preventDefault()\r\n      let evt = e.touches[0]\r\n      const { left, top } = this.canvas.getBoundingClientRect()\r\n      let pageScrollTop = document.documentElement.scrollTop || document.body.scrollTop\r\n      let pageScrollLeft = document.documentElement.scrollLeft || document.body.scrollLeft\r\n      let mouseX = evt.pageX - left - pageScrollLeft\r\n      let mouseY = evt.pageY - top - pageScrollTop\r\n\r\n      this.ctx.beginPath()\r\n      this.ctx.fillStyle = '#FFFFFF'\r\n      this.ctx.arc(mouseX, mouseY, this.fontSize * 0.5, 0, 2 * Math.PI, true)\r\n      this.ctx.fill()\r\n    },\r\n\r\n    touchend(e) {\r\n      e.preventDefault()\r\n      this.checkComplete()\r\n    },\r\n\r\n    checkComplete() {\r\n      let coverData = this.ctx.getImageData(0, 0, this.width, this.height)\r\n      let pxData = coverData.data // 获取字节数据\r\n      let len = pxData.length // 获取字节长度\r\n      let count = 0 // 记录透明点的个数\r\n\r\n      // 主要的思想是 一个像素由四个数据组成，每个数据分别是 rgba() 所以第四个数据 a 表示alpha透明度\r\n      for (let i = 0; i < len; i += 4) {\r\n        let alpha = pxData[i + 3] // 获取每个像素的透明度\r\n        if (alpha < 10) {\r\n          count++\r\n        }\r\n      }\r\n      console.log('count', count)\r\n      let percent = count / (len / 4) // 计算百分比\r\n      console.log('percent', percent)\r\n\r\n      if (percent >= this.option.radio) {\r\n        this.showResult()\r\n      }\r\n    },\r\n\r\n    // 显示刮奖结果\r\n    showResult() {\r\n      this.ctx.clearRect(0, 0, this.width, this.height)\r\n\r\n      let arr = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\r\n      let num = 0\r\n      while (num !== 7) {\r\n        for (let i = 0; i < 10; i++) {\r\n          let len = 0\r\n          arr[Math.floor(Math.random() * arr.length)] = Math.round(Math.random())\r\n          len = arr.filter(i => i === 1).length\r\n          num = len\r\n          if (num === 7) break\r\n        }\r\n      }\r\n\r\n      let result = arr[Math.floor(Math.random() * arr.length)]\r\n      if (result === 1) {\r\n        this.$toast('恭喜您中奖了')\r\n      } else {\r\n        this.$toast('很遗憾，您未中奖')\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.canvasBox {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  box-sizing: border-box;\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .award {\r\n    width: auto;\r\n    height: auto;\r\n    position: absolute;\r\n    left: 50%;\r\n    transform: translateX(-50%);\r\n\r\n    .title {\r\n      p {\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        letter-spacing: 30px;\r\n      }\r\n    }\r\n  }\r\n\r\n  canvas {\r\n    border: 3px dashed #F1F1F1;\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    height: 100%;\r\n    z-index: 10;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./luck-card.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./luck-card.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./luck-card.vue?vue&type=template&id=65b12614&scoped=true&\"\nimport script from \"./luck-card.vue?vue&type=script&lang=js&\"\nexport * from \"./luck-card.vue?vue&type=script&lang=js&\"\nimport style0 from \"./luck-card.vue?vue&type=style&index=0&id=65b12614&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"65b12614\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"container\">\r\n    <div class=\"center\">\r\n      <luck-card :option=\"option\"></luck-card>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport luckCard from '@views/luck-card/luck-card'\r\n// import img from './test.jpg'\r\n\r\nexport default {\r\n  components: {\r\n    luckCard,\r\n  },\r\n  data() {\r\n    return {\r\n      option: {\r\n        // 底部文字样式\r\n        scratchFontSize: 32,\r\n        scratchTextStyle: { 'color': 'red', 'font-weight': '800' },\r\n        // 刮层设置\r\n        scratchColor: '#e5e5e5', // 刮层颜色\r\n        placeholder: '刮开涂层', // 刮层上的文字（若要设置）与img互斥，只能选一个\r\n        fontSize: 32, // 刮层上的文字大小\r\n        fontStyle: '800 Arial', // 刮层上的文字样式\r\n        fontColor: '#a0a0a0', // 刮层上文字颜色\r\n        // img: img, // 刮层上的图片（若要设置）\r\n        radio: 0.1, // 刮开面积占总面积的比例\r\n      },\r\n    }\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.container {\r\n  width: 100%;\r\n  height: 100%;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n\r\n  .center {\r\n    width: 70%;\r\n    height: 200px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./testCard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./testCard.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./testCard.vue?vue&type=template&id=e6f0c2ba&scoped=true&\"\nimport script from \"./testCard.vue?vue&type=script&lang=js&\"\nexport * from \"./testCard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./testCard.vue?vue&type=style&index=0&id=e6f0c2ba&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e6f0c2ba\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}